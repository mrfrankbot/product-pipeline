import{i as A,r as l,j as e}from"./vendor-react-DzgxJkbp.js";import{u as E}from"./vendor-query-BeqrpgNA.js";import{f as P}from"./index-DJAOEm-v.js";import{T}from"./TemplateManager-BQR2aI17.js";import{P as y,C as o,b as r,I as t,x as M,T as s,a,c as g,ac as I,d as B,D as h,B as p,m as k,E as q,o as D,f as F}from"./vendor-polaris-o1SQP_xq.js";const K=()=>{const[v]=A(),S=v.get("category")||void 0,[c,C]=l.useState(""),[x,m]=l.useState(!1),[d,j]=l.useState(null),[b,u]=l.useState(null),{data:n,isLoading:R}=E({queryKey:["images-status"],queryFn:()=>P.get("/images/status"),staleTime:6e4}),w=l.useCallback(async()=>{if(c.trim()){m(!0),j(null),u(null);try{const i=await P.post(`/images/process/${c.trim()}`);j(i)}catch(i){u(i instanceof Error?i.message:"Processing failed")}finally{m(!1)}}},[c]);return R?e.jsx(y,{title:"Image Processor",fullWidth:!0,children:e.jsx(o,{children:e.jsx(r,{padding:"400",children:e.jsxs(t,{align:"center",gap:"200",children:[e.jsx(M,{size:"small"}),e.jsx(s,{as:"span",variant:"bodyMd",children:"Checking PhotoRoom statusâ€¦"})]})})})}):e.jsx(y,{title:"Image Processor",subtitle:"PhotoRoom background removal & product image processing",fullWidth:!0,children:e.jsxs(a,{gap:"500",children:[e.jsx(o,{children:e.jsx(t,{align:"space-between",blockAlign:"center",children:e.jsxs(t,{gap:"300",blockAlign:"center",children:[e.jsx(r,{background:n?.configured?"bg-fill-success-secondary":"bg-fill-warning-secondary",borderRadius:"200",padding:"200",children:e.jsx(g,{source:n?.configured?I:B,tone:n?.configured?"success":"warning"})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{variant:"headingSm",as:"h2",children:"PhotoRoom Integration"}),e.jsx(s,{variant:"bodySm",tone:"subdued",as:"p",children:n?.configured?"API configured and ready":"Setup required"})]})]})})}),e.jsx(o,{children:e.jsxs(a,{gap:"300",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"Configuration"}),e.jsx(h,{}),n?.configured?e.jsx(p,{tone:"success",title:"PhotoRoom API Ready",children:e.jsx(s,{as:"p",children:"PhotoRoom API is configured and ready to use for automatic image processing."})}):e.jsx(p,{tone:"warning",title:"Setup Required",children:e.jsxs(a,{gap:"200",children:[e.jsxs(s,{as:"p",children:["PhotoRoom API is not configured. Set the"," ",e.jsx("code",{children:"PHOTOROOM_API_KEY"})," environment variable to enable automatic image processing."]}),e.jsxs(s,{tone:"subdued",as:"p",children:["Get your API key at"," ",e.jsx("a",{href:"https://app.photoroom.com/api-dashboard",target:"_blank",rel:"noopener noreferrer",children:"app.photoroom.com/api-dashboard"})]})]})})]})}),n?.configured&&e.jsx(o,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(t,{gap:"300",blockAlign:"center",children:[e.jsx(r,{background:"bg-fill-secondary",borderRadius:"200",padding:"200",children:e.jsx(g,{source:k})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"Process Product Images"}),e.jsx(s,{variant:"bodySm",tone:"subdued",as:"p",children:"Remove backgrounds, add white background with drop shadow, and generate clean product images"})]})]}),e.jsx(h,{}),e.jsxs(t,{gap:"300",align:"space-between",wrap:!1,children:[e.jsx(r,{minWidth:"300px",children:e.jsx(q,{label:"",value:c,onChange:C,placeholder:"Enter Shopify Product ID (e.g. 8234567890123)",autoComplete:"off"})}),e.jsx(D,{variant:"primary",onClick:w,loading:x,disabled:!c.trim(),children:x?"Processing...":"Process Images"})]})]})}),b&&e.jsx(p,{tone:"critical",title:"Processing Failed",onDismiss:()=>u(null),children:e.jsx(s,{as:"p",children:b})}),d&&e.jsx(o,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(t,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"050",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"Processing Complete"}),e.jsxs(s,{variant:"bodySm",tone:"subdued",as:"p",children:[d.processedCount," of ",d.originalCount," images processed successfully"]})]}),e.jsx(r,{background:"bg-fill-success-secondary",borderRadius:"200",padding:"200",children:e.jsx(g,{source:I,tone:"success"})})]}),e.jsx(h,{}),d.images.length===0?e.jsx(r,{padding:"400",children:e.jsxs(a,{gap:"200",inlineAlign:"center",children:[e.jsx(g,{source:k,tone:"subdued"}),e.jsx(s,{tone:"subdued",as:"p",children:"No processed images to display"})]})}):e.jsx(F,{columns:{xs:2,sm:3,md:4},gap:"300",children:d.images.map((i,f)=>e.jsx(o,{children:e.jsx(r,{padding:"200",children:e.jsx("img",{src:i,alt:`Processed image ${f+1}`,style:{width:"100%",height:"auto",maxHeight:"200px",objectFit:"contain",borderRadius:"4px"}})})},f))})]})}),e.jsx(T,{initialCategory:S})]})})};export{K as default};
