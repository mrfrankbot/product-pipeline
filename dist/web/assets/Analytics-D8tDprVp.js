import{r as w,j as e}from"./vendor-react-DzgxJkbp.js";import{s as D,t as T}from"./index-DJAOEm-v.js";import{P as m,B as M,T as n,a as t,L as b,C as l,I as o,b as x,c as j,s as y,D as g,f as B,g as C,h as f,S as E,G as v,a5 as S,d as I,e as R}from"./vendor-polaris-o1SQP_xq.js";import"./vendor-query-BeqrpgNA.js";const A=i=>{if(!i)return"—";const r=new Date(i);if(Number.isNaN(r.getTime()))return"—";const a=new Date().getTime()-r.getTime();return a<6e4?"Just now":a<36e5?`${Math.floor(a/6e4)}m ago`:a<864e5?`${Math.floor(a/36e5)}h ago`:r.toLocaleDateString()},h=({label:i,value:r,icon:d,tone:a})=>e.jsx(l,{children:e.jsxs(t,{gap:"200",children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsx(x,{background:a==="success"?"bg-fill-success-secondary":a==="critical"?"bg-fill-critical-secondary":a==="warning"?"bg-fill-warning-secondary":"bg-fill-secondary",borderRadius:"200",padding:"200",children:e.jsx(j,{source:d,tone:a??"base"})})}),e.jsx(n,{variant:"headingXl",as:"p",children:typeof r=="number"?r.toLocaleString():r}),e.jsx(n,{variant:"bodySm",tone:"subdued",as:"p",children:i})]})}),O=()=>{const{data:i,isLoading:r,error:d}=D(100),{data:a,isLoading:L,error:p}=T(),c=w.useMemo(()=>i?.data?i.data.filter(s=>s.status==="error").slice(0,6).map(s=>[s.topic??s.message??"Error",s.source??"System",A(s.createdAt??s.created_at)]):[],[i]),u=r||L;return d||p?e.jsx(m,{title:"Analytics",subtitle:"Sync history and listing health",fullWidth:!0,children:e.jsx(M,{tone:"critical",title:"Analytics unavailable",children:e.jsx(n,{as:"p",children:d?.message??p?.message})})}):e.jsx(m,{title:"Analytics",subtitle:"Sync history and listing health",fullWidth:!0,children:e.jsxs(t,{gap:"500",children:[e.jsx(b,{children:e.jsx(b.Section,{children:e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsxs(o,{gap:"300",blockAlign:"center",children:[e.jsx(x,{background:"bg-fill-secondary",borderRadius:"200",padding:"200",children:e.jsx(j,{source:y})}),e.jsxs(t,{gap:"050",children:[e.jsx(n,{variant:"headingMd",as:"h2",children:"Listing Health"}),e.jsx(n,{variant:"bodySm",tone:"subdued",as:"p",children:"Overview of your active listings and performance"})]})]}),e.jsx(g,{}),e.jsx(B,{columns:{xs:2,sm:2,md:4},gap:"300",children:u?e.jsx(e.Fragment,{children:[1,2,3,4].map(s=>e.jsx(l,{children:e.jsxs(t,{gap:"200",children:[e.jsx(C,{size:"large"}),e.jsx(f,{lines:1})]})},s))}):e.jsxs(e.Fragment,{children:[e.jsx(h,{label:"Active Listings",value:a?.totalActive??0,icon:E,tone:(a?.totalActive??0)>0?"success":void 0}),e.jsx(h,{label:"Ended Listings",value:a?.totalEnded??0,icon:v}),e.jsx(h,{label:"Avg Days Listed",value:a?.averageDaysListed??0,icon:v}),e.jsx(h,{label:"Revenue",value:`$${(a?.revenue??0).toLocaleString()}`,icon:y,tone:(a?.revenue??0)>0?"success":void 0})]})})]})})})}),!u&&Object.keys(a?.ageBuckets??{}).length>0&&e.jsx(l,{children:e.jsxs(t,{gap:"300",children:[e.jsx(n,{variant:"headingMd",as:"h2",children:"Age Distribution"}),e.jsx(g,{}),e.jsx(S,{columnContentTypes:["text","numeric"],headings:["Age Bucket","Listings"],rows:Object.entries(a?.ageBuckets??{}).map(([s,k])=>[s,k])})]})}),e.jsx(l,{children:e.jsxs(t,{gap:"300",children:[e.jsxs(o,{gap:"300",blockAlign:"center",children:[e.jsx(x,{background:c.length>0?"bg-fill-critical-secondary":"bg-fill-success-secondary",borderRadius:"200",padding:"200",children:e.jsx(j,{source:I,tone:c.length>0?"critical":"success"})}),e.jsxs(t,{gap:"050",children:[e.jsx(n,{variant:"headingMd",as:"h2",children:"Recent Errors"}),e.jsx(n,{variant:"bodySm",tone:"subdued",as:"p",children:c.length===0?"No recent errors — all clear!":`${c.length} error${c.length!==1?"s":""} found`})]})]}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(g,{}),e.jsx(S,{columnContentTypes:["text","text","text"],headings:["Message","Source","Timestamp"],rows:c})]})]})}),e.jsx(l,{children:e.jsxs(t,{gap:"300",children:[e.jsx(n,{variant:"headingMd",as:"h2",children:"Latest Sync History"}),e.jsx(g,{}),u?e.jsx(f,{lines:6}):(i?.data??[]).length===0?e.jsx(t,{gap:"200",inlineAlign:"center",children:e.jsx(n,{tone:"subdued",as:"p",children:"No sync activity yet"})}):e.jsx(t,{gap:"300",children:(i?.data??[]).slice(0,8).map(s=>e.jsxs(o,{align:"space-between",blockAlign:"start",children:[e.jsxs(t,{gap:"050",children:[e.jsx(n,{variant:"bodyMd",as:"p",fontWeight:"medium",children:s.topic??s.message??"Sync event"}),e.jsx(n,{variant:"bodySm",tone:"subdued",as:"p",children:s.source??"System"})]}),e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(R,{tone:s.status==="error"?"critical":s.status==="warning"?"warning":s.status==="success"?"success":"info",children:s.status??"info"}),e.jsx(n,{variant:"bodySm",tone:"subdued",as:"p",children:A(s.createdAt??s.created_at)})]})]},String(s.id??Math.random())))})]})})]})})};export{O as default};
