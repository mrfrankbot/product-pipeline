import{r as g,j as e}from"./vendor-react-DzgxJkbp.js";import{a as ae,u as G,b as U}from"./vendor-query-BeqrpgNA.js";import{o as oe,p as re,q as ce,r as le,u as de,f as C}from"./index-DJAOEm-v.js";import{a1 as pe,L as p,C as l,h as he,P as Q,B as ge,a as t,I as s,T as a,e as P,o as c,a2 as H,x as ue,M as me,U as _,b as D,a0 as ye,E as m,a3 as xe,a4 as je}from"./vendor-polaris-o1SQP_xq.js";var be={};const fe={"Mint / Like New":"Virtually indistinguishable from new. No visible wear, perfect optics.","Like New Minus":"Near-perfect with only the faintest handling marks. Optics pristine.","Excellent Plus":"Light signs of normal use, minor cosmetic marks. Optics clean, no haze/fungus/scratches.",Excellent:"Normal cosmetic wear consistent with regular use. All functions work perfectly. Optics clear.","Excellent Minus":"Moderate cosmetic wear, possible light marks on barrel. Optics clean and functional.","Good Plus":"Visible wear and cosmetic marks. Fully functional, optics may show minor dust (does not affect image quality).",Good:"Heavy wear, possible brassing or paint loss. Fully functional.","Open Box":"This item has been opened and inspected but shows no signs of use. Includes all original packaging and accessories."},B=[{categoryId:"31388",name:"Digital Cameras",keywords:["digital camera","dslr","mirrorless","camera body","camera"],priority:100},{categoryId:"3323",name:"Camera Lenses",keywords:["lens","lenses","prime lens","zoom lens","wide angle","telephoto"],priority:90},{categoryId:"4201",name:"Film Photography Film",keywords:["camera film","film","35mm film","instant","polaroid film","instax"],priority:85},{categoryId:"78997",name:"Film Photography Cameras",keywords:["film camera","film slr","35mm camera","rangefinder","medium format camera"],priority:80},{categoryId:"183331",name:"Flashes & Flash Accessories",keywords:["flash","speedlight","speedlite","strobe"],priority:75},{categoryId:"30090",name:"Tripods & Monopods",keywords:["tripod","monopod","gimbal","stabilizer"],priority:70},{categoryId:"29982",name:"Camera Bags & Cases",keywords:["bag","case","backpack","camera bag"],priority:65},{categoryId:"48446",name:"Binoculars & Telescopes",keywords:["binocular","binoculars","telescope","spotting scope"],priority:60},{categoryId:"48528",name:"Camera Filters",keywords:["filter","uv filter","nd filter","polarizer","cpl"],priority:55},{categoryId:"48444",name:"Other Camera Accessories",keywords:["accessory","accessories","strap","remote","adapter","battery","charger"],priority:50}],ke=()=>{const{data:o,isLoading:V,error:E}=oe();re();const{data:y,isLoading:Y,refetch:M}=ce(),x=le(),{connections:z}=de(),F=ae(),[L,h]=g.useState({}),{data:O}=G({queryKey:["condition-descriptions"],queryFn:()=>C.get("/settings/condition-descriptions")}),[R,N]=g.useState({}),[j,b]=g.useState("idle"),q=g.useMemo(()=>({...fe,...O??{},...R}),[O,R]),$=U({mutationFn:n=>C.put("/settings/condition-descriptions",n),onSuccess:()=>{b("saved"),N({}),F.invalidateQueries({queryKey:["condition-descriptions"]}),setTimeout(()=>b("idle"),3e3)},onError:()=>{b("error"),setTimeout(()=>b("idle"),4e3)}}),J=()=>{b("saving"),$.mutate(q)},{data:k}=G({queryKey:["ebay-categories"],queryFn:()=>C.get("/settings/ebay-categories")}),[T,w]=g.useState([]),[f,v]=g.useState("idle");g.useEffect(()=>{k&&T.length===0&&w(k)},[k]);const W=T.length>0?T:k??B,X=U({mutationFn:n=>C.put("/settings/ebay-categories",n),onSuccess:()=>{v("saved"),F.invalidateQueries({queryKey:["ebay-categories"]}),setTimeout(()=>v("idle"),3e3)},onError:()=>{v("error"),setTimeout(()=>v("idle"),4e3)}}),Z=()=>{v("saving"),X.mutate(W)},A=(n,i,r)=>{w(u=>{const S=[...u.length>0?u:B];return S[n]={...S[n],[i]:r},S})},ee=()=>{w(n=>[...n.length>0?n:B,{categoryId:"",name:"New Category",keywords:[],priority:10}])},ne=n=>{w(i=>(i.length>0?i:B).filter((u,S)=>S!==n))},d=g.useMemo(()=>({auto_sync_enabled:o?.auto_sync_enabled??"false",sync_interval_minutes:o?.sync_interval_minutes??"5",sync_inventory:o?.sync_inventory??"true",sync_price:o?.sync_price??"true",description_prompt:o?.description_prompt??"",photoroom_template_id:o?.photoroom_template_id??"",pipeline_auto_descriptions:o?.pipeline_auto_descriptions??"0",pipeline_auto_images:o?.pipeline_auto_images??"0",...o,...L}),[o,L]),I=()=>{x.mutate(d)},ie=()=>{window.open("/auth","_blank","width=600,height=700")},te=()=>{window.open("/ebay/auth","_blank","width=600,height=700")},se=async()=>{await C.delete("/ebay/auth"),M()},K=!!(o?.photoroom_api_key_configured==="true"||be.PHOTOROOM_API_KEY);return V?e.jsx(pe,{title:"Settings",children:e.jsx(p,{children:e.jsx(p.AnnotatedSection,{title:"Connections",description:"Loading...",children:e.jsx(l,{children:e.jsx(he,{lines:4})})})})}):E?e.jsx(Q,{title:"Settings",children:e.jsx(ge,{tone:"critical",title:"Settings unavailable",children:e.jsx("p",{children:E.message})})}):e.jsx(Q,{title:"Settings",children:e.jsxs(p,{children:[e.jsx(p.AnnotatedSection,{title:"Connections",description:"Platform integrations and authentication",children:e.jsxs(t,{gap:"400",children:[e.jsx(l,{children:e.jsxs(t,{gap:"300",children:[e.jsx(s,{align:"space-between",blockAlign:"center",children:e.jsxs(s,{gap:"200",blockAlign:"center",children:[e.jsx(a,{variant:"headingMd",as:"h3",children:"ðŸ›ï¸ Shopify"}),e.jsx(P,{tone:z.shopify?"success":"critical",children:z.shopify?"Connected":"Disconnected"})]})}),e.jsx(a,{variant:"bodySm",as:"p",tone:"subdued",children:"Connect Shopify to sync products, inventory, and pricing."}),e.jsx(c,{icon:H,onClick:ie,size:"slim",children:"Connect Shopify"})]})}),e.jsx(l,{children:e.jsxs(t,{gap:"300",children:[e.jsx(s,{align:"space-between",blockAlign:"center",children:e.jsxs(s,{gap:"200",blockAlign:"center",children:[e.jsx(a,{variant:"headingMd",as:"h3",children:"ðŸ›’ eBay"}),Y?e.jsx(ue,{size:"small",accessibilityLabel:"Checking eBay status"}):e.jsx(P,{tone:y?.connected?"success":"critical",children:y?.connected?"Connected":"Disconnected"})]})}),e.jsx(a,{variant:"bodySm",as:"p",tone:"subdued",children:y?.connected?"eBay account is authorized. Products will sync automatically.":"Authorize your eBay seller account to enable listing sync."}),e.jsxs(s,{gap:"200",children:[e.jsx(c,{icon:H,onClick:te,size:"slim",children:y?.connected?"Reconnect eBay":"Connect eBay"}),e.jsx(c,{icon:me,onClick:()=>M(),size:"slim",children:"Refresh"}),y?.connected&&e.jsx(c,{tone:"critical",onClick:se,size:"slim",children:"Disconnect"})]})]})})]})}),e.jsx(p.AnnotatedSection,{title:"Sync",description:"Control how and when products sync between Shopify and eBay",children:e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsxs(t,{gap:"200",children:[e.jsx(_,{label:"Auto-sync enabled",checked:String(d.auto_sync_enabled)==="true",onChange:n=>h(i=>({...i,auto_sync_enabled:n?"true":"false"}))}),e.jsx(_,{label:"Sync inventory",checked:String(d.sync_inventory)==="true",onChange:n=>h(i=>({...i,sync_inventory:n?"true":"false"}))}),e.jsx(_,{label:"Sync price",checked:String(d.sync_price)==="true",onChange:n=>h(i=>({...i,sync_price:n?"true":"false"}))})]}),e.jsx(D,{maxWidth:"200px",children:e.jsx(ye,{label:"Sync interval (minutes)",options:[{label:"5 minutes",value:"5"},{label:"10 minutes",value:"10"},{label:"15 minutes",value:"15"},{label:"30 minutes",value:"30"}],value:String(d.sync_interval_minutes),onChange:n=>h(i=>({...i,sync_interval_minutes:n}))})}),e.jsx(s,{align:"end",children:e.jsx(c,{variant:"primary",onClick:I,loading:x.isPending,size:"slim",children:"Save sync settings"})})]})})}),e.jsx(p.AnnotatedSection,{title:"Pipeline",description:"Automatic processing steps for new products entering the pipeline",children:e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsxs(t,{gap:"200",children:[e.jsx(_,{label:"Auto-generate descriptions on new products",checked:String(d.pipeline_auto_descriptions)==="1",onChange:n=>h(i=>({...i,pipeline_auto_descriptions:n?"1":"0"}))}),e.jsx(_,{label:"Auto-process images on new products",checked:String(d.pipeline_auto_images)==="1",onChange:n=>h(i=>({...i,pipeline_auto_images:n?"1":"0"}))})]}),e.jsx(s,{align:"end",children:e.jsx(c,{variant:"primary",onClick:I,loading:x.isPending,size:"slim",children:"Save pipeline settings"})})]})})}),e.jsx(p.AnnotatedSection,{title:"Photo Processing",description:"PhotoRoom integration and image template settings",children:e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsx(m,{label:"PhotoRoom Template ID",value:String(d.photoroom_template_id),onChange:n=>h(i=>({...i,photoroom_template_id:n})),autoComplete:"off",helpText:"The PhotoRoom template used to render product images."}),e.jsxs(s,{gap:"200",blockAlign:"center",children:[e.jsx(a,{variant:"bodySm",as:"span",tone:"subdued",children:"PhotoRoom API key:"}),e.jsx(P,{tone:K?"success":"critical",children:K?"Configured":"Not configured"})]}),e.jsx(s,{align:"end",children:e.jsx(c,{variant:"primary",onClick:I,loading:x.isPending,size:"slim",children:"Save photo settings"})})]})})}),e.jsx(p.AnnotatedSection,{title:"eBay",description:"Condition descriptions, category mappings, and listing defaults",children:e.jsxs(t,{gap:"400",children:[e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsx(a,{variant:"headingMd",as:"h3",children:"Condition Grade Descriptions"}),e.jsx(a,{variant:"bodySm",as:"p",tone:"subdued",children:"Edit the descriptions shown on eBay listings for each condition grade. These appear as the item condition notes visible to buyers."}),e.jsx(t,{gap:"300",children:Object.entries(q).map(([n,i])=>e.jsxs(t,{gap:"100",children:[e.jsx(a,{variant:"bodyMd",as:"span",fontWeight:"semibold",children:n}),e.jsx(m,{label:"",labelHidden:!0,value:i,onChange:r=>N(u=>({...u,[n]:r})),multiline:2,autoComplete:"off"})]},n))}),e.jsxs(s,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{variant:"bodySm",as:"span",tone:j==="saved"?"success":j==="error"?"critical":"subdued",children:[j==="saved"&&"âœ“ Saved",j==="error"&&"âœ— Failed to save"]}),e.jsx(c,{variant:"primary",onClick:J,loading:j==="saving",size:"slim",children:"Save descriptions"})]})]})}),e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsx(a,{variant:"headingMd",as:"h3",children:"eBay Category Mappings"}),e.jsx(a,{variant:"bodySm",as:"p",tone:"subdued",children:"Map Shopify product types to eBay category IDs. Keywords are matched against the product type (comma-separated, lowercased)."}),e.jsx(t,{gap:"300",children:W.map((n,i)=>e.jsx(l,{children:e.jsxs(t,{gap:"200",children:[e.jsxs(s,{align:"space-between",blockAlign:"center",children:[e.jsx(a,{variant:"bodyMd",as:"span",fontWeight:"semibold",children:n.name||`Category ${i+1}`}),e.jsx(c,{icon:xe,onClick:()=>ne(i),tone:"critical",variant:"plain",accessibilityLabel:"Remove category"})]}),e.jsxs(s,{gap:"200",wrap:!0,children:[e.jsx(D,{minWidth:"180px",maxWidth:"240px",children:e.jsx(m,{label:"Category Name",value:n.name,onChange:r=>A(i,"name",r),autoComplete:"off"})}),e.jsx(D,{minWidth:"120px",maxWidth:"140px",children:e.jsx(m,{label:"eBay ID",value:n.categoryId,onChange:r=>A(i,"categoryId",r),placeholder:"e.g. 31388",autoComplete:"off"})}),e.jsx(D,{minWidth:"80px",maxWidth:"100px",children:e.jsx(m,{label:"Priority",type:"number",value:String(n.priority),onChange:r=>A(i,"priority",parseInt(r)||0),autoComplete:"off"})})]}),e.jsx(m,{label:"Keywords",value:Array.isArray(n.keywords)?n.keywords.join(", "):n.keywords,onChange:r=>A(i,"keywords",r.split(",").map(u=>u.trim()).filter(Boolean)),placeholder:"camera, dslr, mirrorlessâ€¦",autoComplete:"off"})]})},i))}),e.jsx(c,{icon:je,onClick:ee,variant:"plain",size:"slim",children:"Add category"}),e.jsxs(s,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{variant:"bodySm",as:"span",tone:f==="saved"?"success":f==="error"?"critical":"subdued",children:[f==="saved"&&"âœ“ Saved",f==="error"&&"âœ— Failed to save"]}),e.jsx(c,{variant:"primary",onClick:Z,loading:f==="saving",size:"slim",children:"Save categories"})]})]})})]})}),e.jsx(p.AnnotatedSection,{title:"AI Descriptions",description:"Configure the AI prompt used to generate eBay listing descriptions",children:e.jsx(l,{children:e.jsxs(t,{gap:"400",children:[e.jsxs(s,{gap:"200",blockAlign:"center",children:[e.jsx(a,{variant:"bodySm",as:"span",tone:"subdued",children:"OpenAI API key:"}),e.jsx(P,{tone:o?.openai_api_key_configured==="true"?"success":"critical",children:o?.openai_api_key_configured==="true"?"Configured":"Not configured"})]}),e.jsx(m,{label:"Description Generation Prompt",value:String(d.description_prompt),onChange:n=>h(i=>({...i,description_prompt:n})),multiline:10,autoComplete:"off",helpText:"This prompt is sent to the AI when generating product descriptions for new listings."}),e.jsx(s,{align:"end",children:e.jsx(c,{variant:"primary",onClick:I,loading:x.isPending,size:"slim",children:"Save prompt"})})]})})})]})})};export{ke as default};
